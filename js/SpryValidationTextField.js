(function(){if(typeof Spry=="undefined")window.Spry={};if(!Spry.Widget)Spry.Widget={};Spry.Widget.BrowserSniff=function(){var e=navigator.appName.toString();var t=navigator.platform.toString();var n=navigator.userAgent.toString();this.mozilla=this.ie=this.opera=this.safari=false;var r=/Opera.([0-9\.]*)/i;var i=/MSIE.([0-9\.]*)/i;var s=/gecko/i;var o=/(applewebkit|safari)\/([\d\.]*)/i;var u=false;if(u=n.match(r)){this.opera=true;this.version=parseFloat(u[1])}else if(u=n.match(i)){this.ie=true;this.version=parseFloat(u[1])}else if(u=n.match(o)){this.safari=true;this.version=parseFloat(u[2])}else if(n.match(s)){var a=/rv:\s*([0-9\.]+)/i;u=n.match(a);this.mozilla=true;this.version=parseFloat(u[1])}this.windows=this.mac=this.linux=false;this.Platform=n.match(/windows/i)?"windows":n.match(/linux/i)?"linux":n.match(/mac/i)?"mac":n.match(/unix/i)?"unix":"unknown";this[this.Platform]=true;this.v=this.version;if(this.safari&&this.mac&&this.mozilla){this.mozilla=false}};Spry.is=new Spry.Widget.BrowserSniff;Spry.Widget.ValidationTextField=function(e,t,n){t=Spry.Widget.Utils.firstValid(t,"none");if(typeof t!="string"){this.showError("The second parameter in the constructor should be the validation type, the options are the third parameter.");return}if(typeof Spry.Widget.ValidationTextField.ValidationDescriptors[t]=="undefined"){this.showError("Unknown validation type received as the second parameter.");return}n=Spry.Widget.Utils.firstValid(n,{});this.type=t;if(!this.isBrowserSupported()){n.useCharacterMasking=false}this.init(e,n);var r=["submit"].concat(Spry.Widget.Utils.firstValid(this.options.validateOn,[]));r=r.join(",");this.validateOn=0;this.validateOn=this.validateOn|(r.indexOf("submit")!=-1?Spry.Widget.ValidationTextField.ONSUBMIT:0);this.validateOn=this.validateOn|(r.indexOf("blur")!=-1?Spry.Widget.ValidationTextField.ONBLUR:0);this.validateOn=this.validateOn|(r.indexOf("change")!=-1?Spry.Widget.ValidationTextField.ONCHANGE:0);if(Spry.Widget.ValidationTextField.onloadDidFire)this.attachBehaviors();else Spry.Widget.ValidationTextField.loadQueue.push(this)};Spry.Widget.ValidationTextField.ONCHANGE=1;Spry.Widget.ValidationTextField.ONBLUR=2;Spry.Widget.ValidationTextField.ONSUBMIT=4;Spry.Widget.ValidationTextField.ERROR_REQUIRED=1;Spry.Widget.ValidationTextField.ERROR_FORMAT=2;Spry.Widget.ValidationTextField.ERROR_RANGE_MIN=4;Spry.Widget.ValidationTextField.ERROR_RANGE_MAX=8;Spry.Widget.ValidationTextField.ERROR_CHARS_MIN=13;Spry.Widget.ValidationTextField.ERROR_CHARS_MAX=32;Spry.Widget.ValidationTextField.ValidationDescriptors={none:{},custom:{},integer:{characterMasking:/[\-\+\d]/,regExpFilter:/^[\-\+]?\d*$/,validation:function(e,t){if(e==""||e=="-"||e=="+"){return false}var n=/^[\-\+]?\d*$/;if(!n.test(e)){return false}t=t||{allowNegative:false};var r=parseInt(e,10);if(!isNaN(r)){var i=true;if(typeof t.allowNegative!="undefined"&&t.allowNegative==false){i=false}if(!i&&e<0){r=false}}else{r=false}return r}},real:{characterMasking:/[\d\.,\-\+e]/i,regExpFilter:/^[\-\+]?\d(?:|\.,\d{0,2})|(?:|e{0,1}[\-\+]?\d{0,})$/i,validation:function(e,t){var n=/^[\+\-]?[0-9]+([\.,][0-9]+)?([eE]{0,1}[\-\+]?[0-9]+)?$/;if(!n.test(e)){return false}var r=parseFloat(e);if(isNaN(r)){r=false}return r}},currency:{formats:{dot_comma:{characterMasking:/[\d\.\,\-\+\$]/,regExpFilter:/^[\-\+]?(?:[\d\.]*)+(|\,\d{0,2})$/,validation:function(e,t){var n=false;if(/^(\-|\+)?\d{1,3}(?:\.\d{3})*(?:\,\d{2}|)$/.test(e)||/^(\-|\+)?\d+(?:\,\d{2}|)$/.test(e)){e=e.toString().replace(/\./gi,"").replace(/\,/,".");n=parseFloat(e)}return n}},comma_dot:{characterMasking:/[\d\.\,\-\+\$]/,regExpFilter:/^[\-\+]?(?:[\d\,]*)+(|\.\d{0,2})$/,validation:function(e,t){var n=false;if(/^(\-|\+)?\d{1,3}(?:\,\d{3})*(?:\.\d{2}|)$/.test(e)||/^(\-|\+)?\d+(?:\.\d{2}|)$/.test(e)){e=e.toString().replace(/\,/gi,"");n=parseFloat(e)}return n}}}},email:{characterMasking:/[^\s]/,validation:function(e,t){var n=/^[\w\.-]+@[\w\.-]+\.\w+$/i;return n.test(e)}},date:{validation:function(e,t){var n=/^([mdy]+)[\.\-\/\\\s]+([mdy]+)[\.\-\/\\\s]+([mdy]+)$/i;var r=this.dateValidationPattern;var i=t.format.match(n);var s=e.match(r);if(i!==null&&s!==null){var o=-1;var u=-1;var a=-1;for(var f=1;f<i.length;f++){switch(i[f].toLowerCase()){case"dd":o=f;break;case"mm":u=f;break;case"yy":case"yyyy":a=f;break}}if(o!=-1&&u!=-1&&a!=-1){var l=-1;var c=parseInt(s[o],10);var h=parseInt(s[u],10);var p=parseInt(s[a],10);if(h<1||h>12){return false}switch(h){case 1:case 3:case 5:case 7:case 8:case 10:case 12:l=31;break;case 4:case 6:case 9:case 11:l=30;break;case 2:if(parseInt(p/4,10)*4==p&&(p%100!=0||p%400==0)){l=29}else{l=28}break}if(c<1||c>l){return false}return new Date(p,h-1,c)}}else{return false}}},time:{validation:function(e,t){var n=/([hmst]+)/gi;var r=/(\d+|AM?|PM?)/gi;var i=t.format.match(n);var s=e.match(r);if(i!==null&&s!==null){if(i.length!=s.length){return false}var o=-1;var u=-1;var a=-1;var f=-1;var l=0,c=0,h=0,p="AM";for(var d=0;d<i.length;d++){switch(i[d].toLowerCase()){case"hh":o=d;break;case"mm":u=d;break;case"ss":a=d;break;case"t":case"tt":f=d;break}}if(o!=-1){var l=parseInt(s[o],10);if(isNaN(l)||l>(i[o]=="HH"?23:12)){return false}}if(u!=-1){var c=parseInt(s[u],10);if(isNaN(c)||c>59){return false}}if(a!=-1){var h=parseInt(s[a],10);if(isNaN(h)||h>59){return false}}if(f!=-1){var p=s[f].toUpperCase();if(i[f].toUpperCase()=="TT"&&!/^a|pm$/i.test(p)||i[f].toUpperCase()=="T"&&!/^a|p$/i.test(p)){return false}}var v=new Date(2e3,0,1,l+(p.charAt(0)=="P"?12:0),c,h);return v}else{return false}}},credit_card:{characterMasking:/\d/,validation:function(e,t){var n=null;t.format=t.format||"ALL";switch(t.format.toUpperCase()){case"ALL":n=/^[3-6]{1}[0-9]{12,18}$/;break;case"VISA":n=/^4(?:[0-9]{12}|[0-9]{15})$/;break;case"MASTERCARD":n=/^5[1-5]{1}[0-9]{14}$/;break;case"AMEX":n=/^3(4|7){1}[0-9]{13}$/;break;case"DISCOVER":n=/^6011[0-9]{12}$/;break;case"DINERSCLUB":n=/^3(?:(0[0-5]{1}[0-9]{11})|(6[0-9]{12})|(8[0-9]{12}))$/;break}if(!n.test(e)){return false}var r=[];var i=1,s="";for(var o=e.length-1;o>=0;o--){if(i%2==0){s=parseInt(e.charAt(o),10)*2;r[r.length]=s.toString().charAt(0);if(s.toString().length==2){r[r.length]=s.toString().charAt(1)}}else{s=e.charAt(o);r[r.length]=s}i++}var u=0;for(o=0;o<r.length;o++){u+=parseInt(r[o],10)}if(u%10==0){return true}return false}},zip_code:{formats:{zip_us9:{pattern:"00000-0000"},zip_us5:{pattern:"00000"},zip_uk:{characterMasking:/[\dA-Z\s]/,validation:function(e,t){return/^[A-Z]{1,2}\d[\dA-Z]?\s?\d[A-Z]{2}$/.test(e)}},zip_canada:{characterMasking:/[\dA-Z\s]/,pattern:"A0A 0A0"},zip_custom:{}}},phone_number:{formats:{phone_us:{pattern:"(000) 000-0000"},phone_custom:{}}},social_security_number:{pattern:"000-00-0000"},ip:{characterMaskingFormats:{ipv4:/[\d\.]/i,ipv6_ipv4:/[\d\.\:A-F\/]/i,ipv6:/[\d\.\:A-F\/]/i},validation:function(e,t){return Spry.Widget.ValidationTextField.validateIP(e,t.format)}},url:{characterMasking:/[^\s]/,validation:function(e,t){var n=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;var r=e.match(n);if(r&&r[4]){var i=r[4].split(".");var s="";for(var o=0;o<i.length;o++){s=Spry.Widget.Utils.punycode_encode(i[o],64);if(!s){return false}else{if(s!=i[o]+"-"){i[o]="xn--"+s}}}i=i.join(".");e=e.replace(n,"$1//"+i+"$5$6$8")}var u=/^(?:https?|ftp)\:\/\/(?:(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=:]|%[0-9a-f]{2,2})*\@)?(?:((?:(?:[a-z0-9][a-z0-9\-]*[a-z0-9]|[a-z0-9])\.)*(?:[a-z][a-z0-9\-]*[a-z0-9]|[a-z])|(?:\[[^\]]*\]))(?:\:[0-9]*)?)(?:\/(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=\:\@]|%[0-9a-f]{2,2})*)*(?:\?(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=\:\@\/\?]|%[0-9a-f]{2,2})*)?(?:\#(?:[a-z0-9\-\._~\!\$\&\'\(\)\*\+\,\;\=\:\@\/\?]|%[0-9a-f]{2,2})*)?$/i;var a=e.match(u);if(a){var f=a[1];if(f){if(f=="[]"){return false}if(f.charAt(0)=="["){f=f.replace(/^\[|\]$/gi,"");return Spry.Widget.ValidationTextField.validateIP(f,"ipv6_ipv4")}else{if(/[^0-9\.]/.test(f)){return true}else{return Spry.Widget.ValidationTextField.validateIP(f,"ipv4")}}}else{return true}}else{return false}}}};Spry.Widget.ValidationTextField.validateIP=function(e,t){var n=[/^(?:[a-f0-9]{1,4}:){7}[a-f0-9]{1,4}(?:\/\d{1,3})?$/i,/^[a-f0-9]{0,4}::(?:\/\d{1,3})?$/i,/^:(?::[a-f0-9]{1,4}){1,6}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){1,6}:(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:)(?::[a-f0-9]{1,4}){1,6}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){2}(?::[a-f0-9]{1,4}){1,5}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){3}(?::[a-f0-9]{1,4}){1,4}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){4}(?::[a-f0-9]{1,4}){1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){5}(?::[a-f0-9]{1,4}){1,2}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){6}(?::[a-f0-9]{1,4})(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){6}(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^:(?::[a-f0-9]{1,4}){0,4}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){1,5}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:)(?::[a-f0-9]{1,4}){1,4}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){2}(?::[a-f0-9]{1,4}){1,3}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){3}(?::[a-f0-9]{1,4}){1,2}:(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i,/^(?:[a-f0-9]{1,4}:){4}(?::[a-f0-9]{1,4}):(?:\d{1,3}\.){3}\d{1,3}(?:\/\d{1,3})?$/i];var r=[/^(\d{1,3}\.){3}\d{1,3}$/i];var i=[];if(t=="ipv6"||t=="ipv6_ipv4"){i=i.concat(n)}if(t=="ipv4"||t=="ipv6_ipv4"){i=i.concat(r)}var s=false;for(var o=0;o<i.length;o++){if(i[o].test(e)){s=true;break}}if(s&&e.indexOf(".")!=-1){var u=e.match(/:?(?:\d{1,3}\.){3}\d{1,3}/i);if(!u){return false}u=u[0].replace(/^:/,"");var a=u.split(".");if(a.length!=4){return false}var f=/^[\-\+]?\d*$/;for(var o=0;o<a.length;o++){if(a[o]==""){return false}var l=parseInt(a[o],10);if(isNaN(l)||l>255||!f.test(a[o])||a[o].length>3||/^0{2,3}$/.test(a[o])){return false}}}if(s&&e.indexOf("/")!=-1){var c=e.match(/\/\d{1,3}$/);if(!c)return false;var h=parseInt(c[0].replace(/^\//,""),10);if(isNaN(h)||h>128||h<1){return false}}return s};Spry.Widget.ValidationTextField.onloadDidFire=false;Spry.Widget.ValidationTextField.loadQueue=[];Spry.Widget.ValidationTextField.prototype.isBrowserSupported=function(){return Spry.is.ie&&Spry.is.v>=5&&Spry.is.windows||Spry.is.mozilla&&Spry.is.v>=1.4||Spry.is.safari||Spry.is.opera&&Spry.is.v>=9};Spry.Widget.ValidationTextField.prototype.init=function(element,options){this.element=this.getElement(element);this.errors=0;this.flags={locked:false,restoreSelection:true};this.options={};this.event_handlers=[];this.validClass="textfieldValidState";this.focusClass="textfieldFocusState";this.requiredClass="textfieldRequiredState";this.hintClass="textfieldHintState";this.invalidFormatClass="textfieldInvalidFormatState";this.invalidRangeMinClass="textfieldMinValueState";this.invalidRangeMaxClass="textfieldMaxValueState";this.invalidCharsMinClass="textfieldMinCharsState";this.invalidCharsMaxClass="textfieldMaxCharsState";this.textfieldFlashTextClass="textfieldFlashText";if(Spry.is.safari){this.flags.lastKeyPressedTimeStamp=0}switch(this.type){case"phone_number":options.format=Spry.Widget.Utils.firstValid(options.format,"phone_us");break;case"currency":options.format=Spry.Widget.Utils.firstValid(options.format,"comma_dot");break;case"zip_code":options.format=Spry.Widget.Utils.firstValid(options.format,"zip_us5");break;case"date":options.format=Spry.Widget.Utils.firstValid(options.format,"mm/dd/yy");break;case"time":options.format=Spry.Widget.Utils.firstValid(options.format,"HH:mm");options.pattern=options.format.replace(/[hms]/gi,"0").replace(/TT/gi,"AM").replace(/T/gi,"A");break;case"ip":options.format=Spry.Widget.Utils.firstValid(options.format,"ipv4");options.characterMasking=Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].characterMaskingFormats[options.format];break}var validationDescriptor={};if(options.format&&Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].formats){if(Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].formats[options.format]){Spry.Widget.Utils.setOptions(validationDescriptor,Spry.Widget.ValidationTextField.ValidationDescriptors[this.type].formats[options.format])}}else{Spry.Widget.Utils.setOptions(validationDescriptor,Spry.Widget.ValidationTextField.ValidationDescriptors[this.type])}options.useCharacterMasking=Spry.Widget.Utils.firstValid(options.useCharacterMasking,false);options.hint=Spry.Widget.Utils.firstValid(options.hint,"");options.isRequired=Spry.Widget.Utils.firstValid(options.isRequired,true);options.additionalError=Spry.Widget.Utils.firstValid(options.additionalError,false);if(options.additionalError)options.additionalError=this.getElement(options.additionalError);options.characterMasking=Spry.Widget.Utils.firstValid(options.characterMasking,validationDescriptor.characterMasking);options.regExpFilter=Spry.Widget.Utils.firstValid(options.regExpFilter,validationDescriptor.regExpFilter);options.pattern=Spry.Widget.Utils.firstValid(options.pattern,validationDescriptor.pattern);options.validation=Spry.Widget.Utils.firstValid(options.validation,validationDescriptor.validation);if(typeof options.validation=="string"){options.validation=eval(options.validation)}options.minValue=Spry.Widget.Utils.firstValid(options.minValue,validationDescriptor.minValue);options.maxValue=Spry.Widget.Utils.firstValid(options.maxValue,validationDescriptor.maxValue);options.minChars=Spry.Widget.Utils.firstValid(options.minChars,validationDescriptor.minChars);options.maxChars=Spry.Widget.Utils.firstValid(options.maxChars,validationDescriptor.maxChars);Spry.Widget.Utils.setOptions(this,options);Spry.Widget.Utils.setOptions(this.options,options)};Spry.Widget.ValidationTextField.prototype.destroy=function(){if(this.event_handlers)for(var e=0;e<this.event_handlers.length;e++){Spry.Widget.Utils.removeEventListener(this.event_handlers[e][0],this.event_handlers[e][1],this.event_handlers[e][2],false)}try{delete this.element}catch(t){}try{delete this.input}catch(t){}try{delete this.form}catch(t){}try{delete this.event_handlers}catch(t){}try{this.selection.destroy()}catch(t){}try{delete this.selection}catch(t){}var n=Spry.Widget.Form.onSubmitWidgetQueue;var r=n.length;for(var e=0;e<r;e++){if(n[e]==this){n.splice(e,1);break}}};Spry.Widget.ValidationTextField.prototype.attachBehaviors=function(){if(this.element){if(this.element.nodeName=="INPUT"){this.input=this.element}else{this.input=Spry.Widget.Utils.getFirstChildWithNodeNameAtAnyLevel(this.element,"INPUT")}}if(this.input){if(this.maxChars){this.input.removeAttribute("maxLength")}this.putHint();this.compilePattern();if(this.type=="date"){this.compileDatePattern()}this.input.setAttribute("AutoComplete","off");this.selection=new Spry.Widget.SelectionDescriptor(this.input);this.oldValue=this.input.value;var e=this;this.event_handlers=[];this.event_handlers.push([this.input,"keydown",function(t){if(e.isDisabled())return true;return e.onKeyDown(t||event)}]);this.event_handlers.push([this.input,"keypress",function(t){if(e.isDisabled())return true;return e.onKeyPress(t||event)}]);if(Spry.is.opera){this.event_handlers.push([this.input,"keyup",function(t){if(e.isDisabled())return true;return e.onKeyUp(t||event)}])}this.event_handlers.push([this.input,"focus",function(t){if(e.isDisabled())return true;return e.onFocus(t||event)}]);this.event_handlers.push([this.input,"blur",function(t){if(e.isDisabled())return true;return e.onBlur(t||event)}]);this.event_handlers.push([this.input,"mousedown",function(t){if(e.isDisabled())return true;return e.onMouseDown(t||event)}]);var t=Spry.is.mozilla||Spry.is.opera||Spry.is.safari?"input":Spry.is.ie?"propertychange":"change";this.event_handlers.push([this.input,t,function(t){if(e.isDisabled())return true;return e.onChange(t||event)}]);if(Spry.is.mozilla||Spry.is.safari){this.event_handlers.push([this.input,"dragdrop",function(t){if(e.isDisabled())return true;e.removeHint();return e.onChange(t||event)}])}else if(Spry.is.ie){this.event_handlers.push([this.input,"drop",function(t){if(e.isDisabled())return true;return e.onDrop(t||event)}])}for(var n=0;n<this.event_handlers.length;n++){Spry.Widget.Utils.addEventListener(this.event_handlers[n][0],this.event_handlers[n][1],this.event_handlers[n][2],false)}this.form=Spry.Widget.Utils.getFirstParentWithNodeName(this.input,"FORM");if(this.form){if(!this.form.attachedSubmitHandler&&!this.form.onsubmit){this.form.onsubmit=function(e){e=e||event;return Spry.Widget.Form.onSubmit(e,e.srcElement||e.currentTarget)};this.form.attachedSubmitHandler=true}if(!this.form.attachedResetHandler){Spry.Widget.Utils.addEventListener(this.form,"reset",function(e){e=e||event;return Spry.Widget.Form.onReset(e,e.srcElement||e.currentTarget)},false);this.form.attachedResetHandler=true}Spry.Widget.Form.onSubmitWidgetQueue.push(this)}}};Spry.Widget.ValidationTextField.prototype.isDisabled=function(){return this.input&&(this.input.disabled||this.input.readOnly)||!this.input};Spry.Widget.ValidationTextField.prototype.getElement=function(e){if(e&&typeof e=="string")return document.getElementById(e);return e};Spry.Widget.ValidationTextField.addLoadListener=function(e){if(typeof window.addEventListener!="undefined")window.addEventListener("load",e,false);else if(typeof document.addEventListener!="undefined")document.addEventListener("load",e,false);else if(typeof window.attachEvent!="undefined")window.attachEvent("onload",e)};Spry.Widget.ValidationTextField.processLoadQueue=function(e){Spry.Widget.ValidationTextField.onloadDidFire=true;var t=Spry.Widget.ValidationTextField.loadQueue;var n=t.length;for(var r=0;r<n;r++)t[r].attachBehaviors()};Spry.Widget.ValidationTextField.addLoadListener(Spry.Widget.ValidationTextField.processLoadQueue);Spry.Widget.ValidationTextField.addLoadListener(function(){Spry.Widget.Utils.addEventListener(window,"unload",Spry.Widget.Form.destroyAll,false)});Spry.Widget.ValidationTextField.prototype.setValue=function(e){this.flags.locked=true;this.input.value=e;this.flags.locked=false;this.oldValue=e;if(!Spry.is.ie){this.onChange()}};Spry.Widget.ValidationTextField.prototype.saveState=function(){this.oldValue=this.input.value;this.selection.update()};Spry.Widget.ValidationTextField.prototype.revertState=function(e){if(e!=this.input.value){this.input.readOnly=true;this.input.value=e;this.input.readOnly=false;if(Spry.is.safari&&this.flags.active){this.input.focus()}}if(this.flags.restoreSelection){this.selection.moveTo(this.selection.start,this.selection.end)}this.redTextFlash()};Spry.Widget.ValidationTextField.prototype.removeHint=function(){if(this.flags.hintOn){this.input.value="";this.flags.hintOn=false;this.removeClassName(this.element,this.hintClass);this.removeClassName(this.additionalError,this.hintClass)}};Spry.Widget.ValidationTextField.prototype.putHint=function(){if(this.hint&&this.input&&this.input.type=="text"&&this.input.value==""){this.flags.hintOn=true;this.input.value=this.hint;this.addClassName(this.element,this.hintClass);this.addClassName(this.additionalError,this.hintClass)}};Spry.Widget.ValidationTextField.prototype.redTextFlash=function(){var e=this;this.addClassName(this.element,this.textfieldFlashTextClass);setTimeout(function(){e.removeClassName(e.element,e.textfieldFlashTextClass)},100)};Spry.Widget.ValidationTextField.prototype.doValidations=function(e,t){if(this.isDisabled())return false;if(this.flags.locked){return false}if(e.length==0&&!this.isRequired){this.errors=0;return false}this.flags.locked=true;var n=false;var r=true;if(!this.options.isRequired&&e.length==0){r=false}var i=0;var s=e;if(this.useCharacterMasking&&this.characterMasking){for(var o=0;o<e.length;o++){if(!this.characterMasking.test(e.charAt(o))){i=i|Spry.Widget.ValidationTextField.ERROR_FORMAT;s=t;n=true;break}}}if(!n&&this.useCharacterMasking&&this.regExpFilter){if(!this.regExpFilter.test(s)){i=i|Spry.Widget.ValidationTextField.ERROR_FORMAT;n=true}}if(!n&&this.pattern){var u=this.patternToRegExp(e.length);if(!u.test(e)){i=i|Spry.Widget.ValidationTextField.ERROR_FORMAT;n=true}else if(this.patternLength!=e.length){i=i|Spry.Widget.ValidationTextField.ERROR_FORMAT}}if(s==""){i=i|Spry.Widget.ValidationTextField.ERROR_REQUIRED}if(!n&&this.pattern&&this.useCharacterMasking){var a=this.getAutoComplete(e.length);if(a){s+=a}}if(!n&&this.minChars!==null&&r){if(e.length<this.minChars){i=i|Spry.Widget.ValidationTextField.ERROR_CHARS_MIN;r=false}}if(!n&&this.maxChars!==null&&r){if(e.length>this.maxChars){i=i|Spry.Widget.ValidationTextField.ERROR_CHARS_MAX;r=false}}if(!n&&this.validation&&r){var f=this.validation(s,this.options);if(false===f){i=i|Spry.Widget.ValidationTextField.ERROR_FORMAT;r=false}else{this.typedValue=f}}if(!n&&this.validation&&this.minValue!==null&&r){var l=this.validation(this.minValue.toString(),this.options);if(l!==false){if(this.typedValue<l){i=i|Spry.Widget.ValidationTextField.ERROR_RANGE_MIN;r=false}}}if(!n&&this.validation&&this.maxValue!==null&&r){var c=this.validation(this.maxValue.toString(),this.options);if(c!==false){if(this.typedValue>c){i=i|Spry.Widget.ValidationTextField.ERROR_RANGE_MAX;r=false}}}if(this.useCharacterMasking&&n){this.revertState(t)}this.errors=i;this.fixedValue=s;this.flags.locked=false;return n};Spry.Widget.ValidationTextField.prototype.onChange=function(e){if(Spry.is.opera&&this.flags.operaRevertOnKeyUp){return true}if(Spry.is.ie&&e&&e.propertyName!="value"){return true}if(this.flags.drop){var t=this;setTimeout(function(){t.flags.drop=false;t.onChange(null)},0);return}if(this.flags.hintOn){return true}if(this.keyCode==8||this.keyCode==46){var n=this.doValidations(this.input.value,this.input.value);this.oldValue=this.input.value;if((n||this.errors)&&this.validateOn&Spry.Widget.ValidationTextField.ONCHANGE){var t=this;setTimeout(function(){t.validate()},0);return true}}var n=this.doValidations(this.input.value,this.oldValue);if((!n||this.errors)&&this.validateOn&Spry.Widget.ValidationTextField.ONCHANGE){var t=this;setTimeout(function(){t.validate()},0)}return true};Spry.Widget.ValidationTextField.prototype.onKeyUp=function(e){if(this.flags.operaRevertOnKeyUp){this.setValue(this.oldValue);Spry.Widget.Utils.stopEvent(e);this.selection.moveTo(this.selection.start,this.selection.start);this.flags.operaRevertOnKeyUp=false;return false}if(this.flags.operaPasteOperation){window.clearInterval(this.flags.operaPasteOperation);this.flags.operaPasteOperation=null}};Spry.Widget.ValidationTextField.prototype.operaPasteMonitor=function(){if(this.input.value!=this.oldValue){var e=this.doValidations(this.input.value,this.input.value);if(e){this.setValue(this.oldValue);this.selection.moveTo(this.selection.start,this.selection.start)}else{this.onChange()}}};Spry.Widget.ValidationTextField.prototype.compileDatePattern=function(){var e="";var t=[];var n=[];var r=[];var i=/^([mdy]+)([\.\-\/\\\s]+)([mdy]+)([\.\-\/\\\s]+)([mdy]+)$/i;var s=this.options.format.match(i);if(s!==null){for(var o=1;o<s.length;o++){switch(s[o].toLowerCase()){case"dd":t[o-1]="\\d{1,2}";n[o-1]="\\d\\d";e+="("+t[o-1]+")";r[o-1]=null;break;case"mm":t[o-1]="\\d{1,2}";n[o-1]="\\d\\d";e+="("+t[o-1]+")";r[o-1]=null;break;case"yy":t[o-1]="\\d{1,2}";n[o-1]="\\d\\d";e+="(\\d\\d)";r[o-1]=null;break;case"yyyy":t[o-1]="\\d{1,4}";n[o-1]="\\d\\d\\d\\d";e+="(\\d\\d\\d\\d)";r[o-1]=null;break;default:t[o-1]=n[o-1]=Spry.Widget.ValidationTextField.regExpFromChars(s[o]);e+="["+t[o-1]+"]";r[o-1]=s[o]}}}this.dateValidationPattern=new RegExp("^"+e+"$","");this.dateAutocompleteCharacters=r;this.dateGroupPatterns=t;this.dateFullGroupPatterns=n;this.lastDateGroup=s.length-2};Spry.Widget.ValidationTextField.prototype.getRegExpForGroup=function(e){var t="^";for(var n=0;n<=e;n++)t+=this.dateGroupPatterns[n];t+="$";return new RegExp(t,"")};Spry.Widget.ValidationTextField.prototype.getRegExpForFullGroup=function(e){var t="^";for(var n=0;n<e;n++)t+=this.dateGroupPatterns[n];t+=this.dateFullGroupPatterns[e];return new RegExp(t,"")};Spry.Widget.ValidationTextField.prototype.getDateGroup=function(e,t){if(t==0)return 0;var n=e.substring(0,t);for(var r=0;r<=this.lastDateGroup;r++)if(this.getRegExpForGroup(r).test(n))return r;return-1};Spry.Widget.ValidationTextField.prototype.isDateGroupFull=function(e,t){return this.getRegExpForFullGroup(t).test(e)};Spry.Widget.ValidationTextField.prototype.isValueValid=function(e,t,n){var r=e.substring(0,t);return this.getRegExpForGroup(n).test(r)};Spry.Widget.ValidationTextField.prototype.isPositionAtEndOfGroup=function(e,t,n){var r=e.substring(0,t);return this.getRegExpForFullGroup(n).test(r)};Spry.Widget.ValidationTextField.prototype.nextDateDelimiterExists=function(e,t,n){var r=this.dateAutocompleteCharacters[n+1];if(e.length<t+r.length)return false;else{var i=e.substring(t,t+r.length);if(i==r)return true}return false};Spry.Widget.ValidationTextField.prototype.onKeyPress=function(e){if(this.flags.skp){this.flags.skp=false;Spry.Widget.Utils.stopEvent(e);return false}if(e.ctrlKey||e.metaKey||!this.useCharacterMasking){return true}if(Spry.is.opera&&this.flags.operaRevertOnKeyUp){Spry.Widget.Utils.stopEvent(e);return false}if(this.keyCode==8||this.keyCode==46){var t=this.doValidations(this.input.value,this.input.value);if(t){return true}}var n=Spry.Widget.Utils.getCharacterFromEvent(e);if(n&&this.characterMasking){if(!this.characterMasking.test(n)){Spry.Widget.Utils.stopEvent(e);this.redTextFlash();return false}}if(n&&this.pattern){var r=this.patternCharacters[this.selection.start];if(/[ax]/i.test(r)){if(r.toLowerCase()==r){n=n.toLowerCase()}else{n=n.toUpperCase()}}var i=this.getAutoComplete(this.selection.start);if(this.selection.start==this.oldValue.length){if(this.oldValue.length<this.patternLength){if(i){Spry.Widget.Utils.stopEvent(e);var s=this.oldValue.substring(0,this.selection.start)+i+n;var o=this.doValidations(s,this.oldValue);if(!o){this.setValue(this.fixedValue);this.selection.moveTo(this.fixedValue.length,this.fixedValue.length)}else{this.setValue(this.oldValue.substring(0,this.selection.start)+i);this.selection.moveTo(this.selection.start+i.length,this.selection.start+i.length)}return false}}else{Spry.Widget.Utils.stopEvent(e);this.setValue(this.input.value);return false}}else if(i){Spry.Widget.Utils.stopEvent(e);this.selection.moveTo(this.selection.start+i.length,this.selection.start+i.length);return false}Spry.Widget.Utils.stopEvent(e);var s=this.oldValue.substring(0,this.selection.start)+n+this.oldValue.substring(this.selection.start+1);var o=this.doValidations(s,this.oldValue);if(!o){i=this.getAutoComplete(this.selection.start+1);this.setValue(this.fixedValue);this.selection.moveTo(this.selection.start+1+i.length,this.selection.start+1+i.length)}else{this.selection.moveTo(this.selection.start,this.selection.start)}return false}if(n&&this.type=="date"&&this.useCharacterMasking){var u=this.getDateGroup(this.oldValue,this.selection.start);if(u!=-1){Spry.Widget.Utils.stopEvent(e);if(u%2!=0)u++;if(this.isDateGroupFull(this.oldValue,u)){if(this.isPositionAtEndOfGroup(this.oldValue,this.selection.start,u)){if(u==this.lastDateGroup){this.redTextFlash();return false}else{var i=this.dateAutocompleteCharacters[u+1];if(this.nextDateDelimiterExists(this.oldValue,this.selection.start,u)){var i=this.dateAutocompleteCharacters[u+1];this.selection.moveTo(this.selection.start+i.length,this.selection.start+i.length);if(n==i)return false;if(this.isDateGroupFull(this.oldValue,u+2))s=this.oldValue.substring(0,this.selection.start)+n+this.oldValue.substring(this.selection.start+1);else s=this.oldValue.substring(0,this.selection.start)+n+this.oldValue.substring(this.selection.start);if(!this.isValueValid(s,this.selection.start+1,u+2)){this.redTextFlash();return false}else{this.setValue(s);this.selection.moveTo(this.selection.start+1,this.selection.start+1)}return false}else{var i=this.dateAutocompleteCharacters[u+1];var a=i+n;s=this.oldValue.substring(0,this.selection.start)+a+this.oldValue.substring(this.selection.start);if(!this.isValueValid(s,this.selection.start+a.length,u+2)){a=i;s=this.oldValue.substring(0,this.selection.start)+a+this.oldValue.substring(this.selection.start);this.setValue(s);this.selection.moveTo(this.selection.start+a.length,this.selection.start+a.length);this.redTextFlash();return false}else{this.setValue(s);this.selection.moveTo(this.selection.start+a.length,this.selection.start+a.length);return false}}}}else{var f=1;s=this.oldValue.substring(0,this.selection.start)+n+this.oldValue.substring(this.selection.start+1);if(!this.isValueValid(s,this.selection.start+1,u)){this.redTextFlash();return false}else{if(this.isPositionAtEndOfGroup(s,this.selection.start+1,u)){if(u!=this.lastDateGroup){if(this.nextDateDelimiterExists(s,this.selection.start+1,u)){var i=this.dateAutocompleteCharacters[u+1];f=1+i.length}else{var i=this.dateAutocompleteCharacters[u+1];s=this.oldValue.substring(0,this.selection.start)+n+i+this.oldValue.substring(this.selection.start+1);f=1+i.length}}}this.setValue(s);this.selection.moveTo(this.selection.start+f,this.selection.start+f);return false}}}else{s=this.oldValue.substring(0,this.selection.start)+n+this.oldValue.substring(this.selection.start);var f=1;if(!this.isValueValid(s,this.selection.start+1,u)&&!this.isValueValid(s,this.selection.start+1,u+1)){this.redTextFlash();return false}else{var i=this.dateAutocompleteCharacters[u+1];if(n==i){if(this.nextDateDelimiterExists(this.oldValue,this.selection.start,u)){s=this.oldValue;f=1}}else{if(this.isPositionAtEndOfGroup(s,this.selection.start+1,u)){if(u!=this.lastDateGroup){if(this.nextDateDelimiterExists(s,this.selection.start+1,u)){var i=this.dateAutocompleteCharacters[u+1];f=1+i.length}else{var i=this.dateAutocompleteCharacters[u+1];s=this.oldValue.substring(0,this.selection.start)+n+i+this.oldValue.substring(this.selection.start+1);f=1+i.length}}}}this.setValue(s);this.selection.moveTo(this.selection.start+f,this.selection.start+f);return false}}}return false}};Spry.Widget.ValidationTextField.prototype.onKeyDown=function(e){this.saveState();this.keyCode=e.keyCode;if(Spry.is.opera){if(this.flags.operaPasteOperation){window.clearInterval(this.flags.operaPasteOperation);this.flags.operaPasteOperation=null}if(e.ctrlKey){var t=Spry.Widget.Utils.getCharacterFromEvent(e);if(t&&"vx".indexOf(t.toLowerCase())!=-1){var n=this;this.flags.operaPasteOperation=window.setInterval(function(){n.operaPasteMonitor()},1);return true}}}if(this.keyCode!=8&&this.keyCode!=46&&Spry.Widget.Utils.isSpecialKey(e)){return true}if(this.keyCode==8||this.keyCode==46){var r=this.doValidations(this.input.value,this.input.value);if(r){return true}}if(this.useCharacterMasking&&this.pattern&&this.keyCode==46){if(e.ctrlKey){this.setValue(this.input.value.substring(0,this.selection.start))}else if(this.selection.end==this.input.value.length||this.selection.start==this.input.value.length-1){return true}else{this.flags.operaRevertOnKeyUp=true}if(Spry.is.mozilla&&Spry.is.mac){this.flags.skp=true}Spry.Widget.Utils.stopEvent(e);return false}if(this.useCharacterMasking&&this.pattern&&!e.ctrlKey&&this.keyCode==8){if(this.selection.start==this.input.value.length){var i=this.getAutoComplete(this.selection.start,-1);this.setValue(this.input.value.substring(0,this.input.value.length-(Spry.is.opera?0:1)-i.length));if(Spry.is.opera){this.selection.start=this.selection.start-1-i.length;this.selection.end=this.selection.end-1-i.length}}else if(this.selection.end==this.input.value.length){return true}else{this.flags.operaRevertOnKeyUp=true}if(Spry.is.mozilla&&Spry.is.mac){this.flags.skp=true}Spry.Widget.Utils.stopEvent(e);return false}return true};Spry.Widget.ValidationTextField.prototype.onMouseDown=function(e){if(this.flags.active){this.saveState()}};Spry.Widget.ValidationTextField.prototype.onDrop=function(e){this.flags.drop=true;this.removeHint();this.saveState();this.flags.active=true;this.addClassName(this.element,this.focusClass);this.addClassName(this.additionalError,this.focusClass)};Spry.Widget.ValidationTextField.prototype.onFocus=function(e){if(this.flags.drop){return}this.removeHint();if(this.pattern&&this.useCharacterMasking){var t=this.getAutoComplete(this.selection.start);this.setValue(this.input.value+t);this.selection.moveTo(this.input.value.length,this.input.value.length)}this.saveState();this.flags.active=true;this.addClassName(this.element,this.focusClass);this.addClassName(this.additionalError,this.focusClass)};Spry.Widget.ValidationTextField.prototype.onBlur=function(e){this.flags.active=false;this.removeClassName(this.element,this.focusClass);this.removeClassName(this.additionalError,this.focusClass);this.flags.restoreSelection=false;var t=this.doValidations(this.input.value,this.input.value);this.flags.restoreSelection=true;if(this.validateOn&Spry.Widget.ValidationTextField.ONBLUR){this.validate()}var n=this;setTimeout(function(){n.putHint()},10);return true};Spry.Widget.ValidationTextField.prototype.compilePattern=function(){if(!this.pattern){return}var e=[];var t=[];var n=[];var r=0;var i="",s="";for(var o=0;o<this.pattern.length;o++){i=this.pattern.charAt(o);if(s=="\\"){if(/[0ABXY\?]/i.test(i)){t[r-1]=i}else{t[r-1]=Spry.Widget.ValidationTextField.regExpFromChars(i)}e[r-1]=i;n[r-1]=null;s="";continue}t[r]=Spry.Widget.ValidationTextField.regExpFromChars(i);if(/[0ABXY\?]/i.test(i)){e[r]=null;n[r]=i}else if(i=="\\"){e[r]=i;n[r]="\\"}else{e[r]=i;n[r]=null}r++;s=i}this.autoCompleteCharacters=e;this.compiledPattern=t;this.patternCharacters=n;this.patternLength=e.length};Spry.Widget.ValidationTextField.prototype.getAutoComplete=function(e,t){if(t==-1){var n="",r="";while(e&&(n=this.getAutoComplete(--e))){r=n}return r}var i="",s="";for(var o=e;o<this.autoCompleteCharacters.length;o++){s=this.autoCompleteCharacters[o];if(s){i+=s}else{break}}return i};Spry.Widget.ValidationTextField.regExpFromChars=function(e){var t="",n="";for(var r=0;r<e.length;r++){n=e.charAt(r);switch(n){case"0":t+="\\d";break;case"A":t+="[A-Z]";break;case"a":t+="[a-z]";break;case"B":case"b":t+="[a-zA-Z]";break;case"x":t+="[0-9a-z]";break;case"X":t+="[0-9A-Z]";break;case"Y":case"y":t+="[0-9a-zA-Z]";break;case"?":t+=".";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":t+=n;break;case"c":case"C":case"e":case"E":case"f":case"F":case"r":case"d":case"D":case"n":case"s":case"S":case"w":case"W":case"t":case"v":t+=n;break;default:t+="\\"+n}}return t};Spry.Widget.ValidationTextField.prototype.patternToRegExp=function(e){var t="^";var n=Math.min(this.compiledPattern.length,e);for(var r=0;r<n;r++){t+=this.compiledPattern[r]}t+="$";t=new RegExp(t,"");return t};Spry.Widget.ValidationTextField.prototype.resetClasses=function(){var e=[this.requiredClass,this.invalidFormatClass,this.invalidRangeMinClass,this.invalidRangeMaxClass,this.invalidCharsMinClass,this.invalidCharsMaxClass,this.validClass];for(var t=0;t<e.length;t++){this.removeClassName(this.element,e[t]);this.removeClassName(this.additionalError,e[t])}};Spry.Widget.ValidationTextField.prototype.reset=function(){this.removeHint();this.oldValue=this.input.defaultValue;this.resetClasses();if(Spry.is.ie){this.input.forceFireFirstOnPropertyChange=true;this.input.removeAttribute("forceFireFirstOnPropertyChange")}var e=this;setTimeout(function(){e.putHint()},10)};Spry.Widget.ValidationTextField.prototype.validate=function(){this.resetClasses();if(this.validateOn&Spry.Widget.ValidationTextField.ONSUBMIT){this.removeHint();this.doValidations(this.input.value,this.input.value);if(!this.flags.active){var e=this;setTimeout(function(){e.putHint()},10)}}if(this.isRequired&&this.errors&Spry.Widget.ValidationTextField.ERROR_REQUIRED){this.addClassName(this.element,this.requiredClass);this.addClassName(this.additionalError,this.requiredClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_FORMAT){this.addClassName(this.element,this.invalidFormatClass);this.addClassName(this.additionalError,this.invalidFormatClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_RANGE_MIN){this.addClassName(this.element,this.invalidRangeMinClass);this.addClassName(this.additionalError,this.invalidRangeMinClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_RANGE_MAX){this.addClassName(this.element,this.invalidRangeMaxClass);this.addClassName(this.additionalError,this.invalidRangeMaxClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_CHARS_MIN){this.addClassName(this.element,this.invalidCharsMinClass);this.addClassName(this.additionalError,this.invalidCharsMinClass);return false}if(this.errors&Spry.Widget.ValidationTextField.ERROR_CHARS_MAX){this.addClassName(this.element,this.invalidCharsMaxClass);this.addClassName(this.additionalError,this.invalidCharsMaxClass);return false}this.addClassName(this.element,this.validClass);this.addClassName(this.additionalError,this.validClass);return true};Spry.Widget.ValidationTextField.prototype.addClassName=function(e,t){if(!e||!t||e.className&&e.className.search(new RegExp("\\b"+t+"\\b"))!=-1)return;e.className+=(e.className?" ":"")+t};Spry.Widget.ValidationTextField.prototype.removeClassName=function(e,t){if(!e||!t||e.className&&e.className.search(new RegExp("\\b"+t+"\\b"))==-1)return;e.className=e.className.replace(new RegExp("\\s*\\b"+t+"\\b","g"),"")};Spry.Widget.ValidationTextField.prototype.showError=function(e){alert("Spry.Widget.TextField ERR: "+e)};Spry.Widget.SelectionDescriptor=function(e){this.element=e;this.update()};Spry.Widget.SelectionDescriptor.prototype.update=function(){if(Spry.is.ie&&Spry.is.windows){var e=this.element.ownerDocument.selection;if(this.element.nodeName=="TEXTAREA"){if(e.type!="None"){try{var t=e.createRange()}catch(n){return}if(t.parentElement()==this.element){var r=this.element.ownerDocument.body.createTextRange();r.moveToElementText(this.element);for(var i=0;r.compareEndPoints("StartToStart",t)<0;i++){r.moveStart("character",1)}this.start=i;r=this.element.ownerDocument.body.createTextRange();r.moveToElementText(this.element);for(var s=0;r.compareEndPoints("StartToEnd",t)<0;s++){r.moveStart("character",1)}this.end=s;this.length=this.end-this.start;this.text=t.text}}}else if(this.element.nodeName=="INPUT"){try{this.range=e.createRange()}catch(n){return}this.length=this.range.text.length;var o=this.range.duplicate();this.start=-o.moveStart("character",-1e4);o=this.range.duplicate();o.collapse(false);this.end=-o.moveStart("character",-1e4);this.text=this.range.text}}else{var u=this.element;var a=0;var f=0;try{a=u.selectionStart}catch(n){}try{f=u.selectionEnd}catch(n){}if(Spry.is.safari){if(a==2147483647){a=0}if(f==2147483647){f=0}}this.start=a;this.end=f;this.length=f-a;this.text=this.element.value.substring(a,f)}};Spry.Widget.SelectionDescriptor.prototype.destroy=function(){try{delete this.range}catch(e){}try{delete this.element}catch(e){}};Spry.Widget.SelectionDescriptor.prototype.move=function(e){if(Spry.is.ie&&Spry.is.windows){this.range.move("character",e);this.range.select()}else{try{this.element.selectionStart++}catch(t){}}this.update()};Spry.Widget.SelectionDescriptor.prototype.moveTo=function(e,t){if(Spry.is.ie&&Spry.is.windows){if(this.element.nodeName=="TEXTAREA"){var n=this.element.createTextRange();this.range=this.element.createTextRange();this.range.move("character",e);this.range.moveEnd("character",t-e);var r=this.range.compareEndPoints("StartToStart",n);if(r<0){this.range.setEndPoint("StartToStart",n)}var i=this.range.compareEndPoints("EndToEnd",n);if(i>0){this.range.setEndPoint("EndToEnd",n)}}else if(this.element.nodeName=="INPUT"){this.range=this.element.ownerDocument.selection.createRange();this.range.move("character",-1e4);this.start=this.range.moveStart("character",e);this.end=this.start+this.range.moveEnd("character",t-e)}this.range.select()}else{this.start=e;try{this.element.selectionStart=e}catch(s){}this.end=t;try{this.element.selectionEnd=t}catch(s){}}this.ignore=true;this.update()};Spry.Widget.SelectionDescriptor.prototype.moveEnd=function(e){if(Spry.is.ie&&Spry.is.windows){this.range.moveEnd("character",e);this.range.select()}else{try{this.element.selectionEnd++}catch(t){}}this.update()};Spry.Widget.SelectionDescriptor.prototype.collapse=function(e){if(Spry.is.ie&&Spry.is.windows){this.range=this.element.ownerDocument.selection.createRange();this.range.collapse(e);this.range.select()}else{if(e){try{this.element.selectionEnd=this.element.selectionStart}catch(t){}}else{try{this.element.selectionStart=this.element.selectionEnd}catch(t){}}}this.update()};if(!Spry.Widget.Form)Spry.Widget.Form={};if(!Spry.Widget.Form.onSubmitWidgetQueue)Spry.Widget.Form.onSubmitWidgetQueue=[];if(!Spry.Widget.Form.validate){Spry.Widget.Form.validate=function(e){var t=true;var n=true;var r=Spry.Widget.Form.onSubmitWidgetQueue;var i=r.length;for(var s=0;s<i;s++){if(!r[s].isDisabled()&&r[s].form==e){n=r[s].validate();t=n&&t}}return t}}if(!Spry.Widget.Form.onSubmit){Spry.Widget.Form.onSubmit=function(e,t){if(Spry.Widget.Form.validate(t)==false){return false}return true}}if(!Spry.Widget.Form.onReset){Spry.Widget.Form.onReset=function(e,t){var n=Spry.Widget.Form.onSubmitWidgetQueue;var r=n.length;for(var i=0;i<r;i++){if(!n[i].isDisabled()&&n[i].form==t&&typeof n[i].reset=="function"){n[i].reset()}}return true}}if(!Spry.Widget.Form.destroy){Spry.Widget.Form.destroy=function(e){var t=Spry.Widget.Form.onSubmitWidgetQueue;for(var n=0;n<Spry.Widget.Form.onSubmitWidgetQueue.length;n++){if(t[n].form==e&&typeof t[n].destroy=="function"){t[n].destroy();n--}}}}if(!Spry.Widget.Form.destroyAll){Spry.Widget.Form.destroyAll=function(){var e=Spry.Widget.Form.onSubmitWidgetQueue;for(var t=0;t<Spry.Widget.Form.onSubmitWidgetQueue.length;t++){if(typeof e[t].destroy=="function"){e[t].destroy();t--}}}}if(!Spry.Widget.Utils)Spry.Widget.Utils={};Spry.Widget.Utils.punycode_constants={base:36,tmin:1,tmax:26,skew:38,damp:700,initial_bias:72,initial_n:128,delimiter:45,maxint:2<<26-1};Spry.Widget.Utils.punycode_encode_digit=function(e){return String.fromCharCode(e+22+75*(e<26))};Spry.Widget.Utils.punycode_adapt=function(e,t,n){e=n?e/this.punycode_constants.damp:e>>1;e+=e/t;for(var r=0;e>(this.punycode_constants.base-this.punycode_constants.tmin)*this.punycode_constants.tmax/2;r+=this.punycode_constants.base){e/=this.punycode_constants.base-this.punycode_constants.tmin}return r+(this.punycode_constants.base-this.punycode_constants.tmin+1)*e/(e+this.punycode_constants.skew)};Spry.Widget.Utils.punycode_encode=function(e,t){var n=e.split("");e=[];for(var r=0;r<n.length;r++){e.push(n[r].charCodeAt(0))}var i="";var s,o,u,a,f,l,c;var h=e.length;var p=this.punycode_constants.initial_n;var d=0;var v=this.punycode_constants.initial_bias;var m=0;for(u=0;u<h;u++){if(e[u]<128){if(t-m<2){return false}i+=String.fromCharCode(e[u]);m++}}s=o=m;if(o>0){i+=String.fromCharCode(this.punycode_constants.delimiter);m++}while(s<h){for(a=this.punycode_constants.maxint,u=0;u<h;u++){if(e[u]>=p&&e[u]<a){a=e[u]}}if(a-p>(this.punycode_constants.maxint-d)/(s+1)){return false}d+=(a-p)*(s+1);p=a;for(u=0;u<h;u++){if(e[u]<p){if(++d==0){return false}}if(e[u]==p){for(f=d,l=this.punycode_constants.base;true;l+=this.punycode_constants.base){if(m>=t){return false}c=l<=v?this.punycode_constants.tmin:l>=v+this.punycode_constants.tmax?this.punycode_constants.tmax:l-v;if(f<c){break}i+=this.punycode_encode_digit(c+(f-c)%(this.punycode_constants.base-c));m++;f=(f-c)/(this.punycode_constants.base-c)}i+=this.punycode_encode_digit(f);m++;v=this.punycode_adapt(d,s+1,s==o);d=0;s++}}d++,p++}return i};Spry.Widget.Utils.setOptions=function(e,t,n){if(!t)return;for(var r in t){if(n&&t[r]==undefined)continue;e[r]=t[r]}};Spry.Widget.Utils.firstValid=function(){var e=null;for(var t=0;t<Spry.Widget.Utils.firstValid.arguments.length;t++){if(typeof Spry.Widget.Utils.firstValid.arguments[t]!="undefined"){e=Spry.Widget.Utils.firstValid.arguments[t];break}}return e};Spry.Widget.Utils.specialCharacters=",8,9,16,17,18,20,27,33,34,35,36,37,38,40,45,144,192,63232,";Spry.Widget.Utils.specialSafariNavKeys="63232,63233,63234,63235,63272,63273,63275,63276,63277,63289,";Spry.Widget.Utils.specialNotSafariCharacters="39,46,91,92,93,";Spry.Widget.Utils.specialCharacters+=Spry.Widget.Utils.specialSafariNavKeys;if(!Spry.is.safari){Spry.Widget.Utils.specialCharacters+=Spry.Widget.Utils.specialNotSafariCharacters}Spry.Widget.Utils.isSpecialKey=function(e){return Spry.Widget.Utils.specialCharacters.indexOf(","+e.keyCode+",")!=-1};Spry.Widget.Utils.getCharacterFromEvent=function(e){var t=e.type=="keydown";var n=null;var r=null;if(Spry.is.mozilla&&!t){if(e.charCode){r=String.fromCharCode(e.charCode)}else{n=e.keyCode}}else{n=e.keyCode||e.which;if(n!=13){r=String.fromCharCode(n)}}if(Spry.is.safari){if(t){n=e.keyCode||e.which;r=String.fromCharCode(n)}else{n=e.keyCode||e.which;if(Spry.Widget.Utils.specialCharacters.indexOf(","+n+",")!=-1){r=null}else{r=String.fromCharCode(n)}}}if(Spry.is.opera){if(Spry.Widget.Utils.specialCharacters.indexOf(","+n+",")!=-1){r=null}else{r=String.fromCharCode(n)}}return r};Spry.Widget.Utils.getFirstChildWithNodeNameAtAnyLevel=function(e,t){var n=e.getElementsByTagName(t);if(n){return n[0]}return null};Spry.Widget.Utils.getFirstParentWithNodeName=function(e,t){while(e.parentNode&&e.parentNode.nodeName.toLowerCase()!=t.toLowerCase()&&e.parentNode.nodeName!="BODY"){e=e.parentNode}if(e.parentNode&&e.parentNode.nodeName.toLowerCase()==t.toLowerCase()){return e.parentNode}else{return null}};Spry.Widget.Utils.destroyWidgets=function(e){if(typeof e=="string"){e=document.getElementById(e)}var t=Spry.Widget.Form.onSubmitWidgetQueue;for(var n=0;n<Spry.Widget.Form.onSubmitWidgetQueue.length;n++){if(typeof t[n].destroy=="function"&&Spry.Widget.Utils.contains(e,t[n].element)){t[n].destroy();n--}}};Spry.Widget.Utils.contains=function(e,t){if(typeof e.contains=="object"){return t&&e&&(e==t||e.contains(t))}else{var n=t;while(n){if(n==e){return true}n=n.parentNode}return false}};Spry.Widget.Utils.addEventListener=function(e,t,n,r){try{if(e.addEventListener)e.addEventListener(t,n,r);else if(e.attachEvent)e.attachEvent("on"+t,n,r)}catch(i){}};Spry.Widget.Utils.removeEventListener=function(e,t,n,r){try{if(e.removeEventListener)e.removeEventListener(t,n,r);else if(e.detachEvent)e.detachEvent("on"+t,n,r)}catch(i){}};Spry.Widget.Utils.stopEvent=function(e){try{this.stopPropagation(e);this.preventDefault(e)}catch(t){}};Spry.Widget.Utils.stopPropagation=function(e){if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}};Spry.Widget.Utils.preventDefault=function(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}})()